syntax = "proto3";

import "base_types.proto";

package pb_message.game_data;


message unit_design_t
{
    int32 id = 1;
    int32 owner = 2;
    int32 hull = 3;
    int32 armor = 4;
    int32 propulsion = 5;
    int32 weapons = 6;
    int32 shields = 7;
    int32 detection = 8;
    int32 stealth = 9;
    int32 automation = 10;
    int32 attack = 11;
    int32 defense = 12;
    int32 ground_attack = 13;
}

message unit_t
{
    int32 design_id = 1;
    int32 design_owner = 2;
    int32 health = 3; // <= design.defense
}

message fleet_t
{
    uint32 id = 1;
    pb_message.mission_t mission = 2;
    repeated unit_t units = 3;
    float fuel = 4;
    int32 rounds = 5;
    int32 missiles = 6;
    int32 fighters = 7;
}

message fleets_t
{
    map<int32, fleet_t> fleets = 1;
}

enum planet_type_t {
    invalid_planet_type = 0;
    rocky = 1;
    gas_giant = 2;
    ice_giant = 3;
}

enum atmosphere_type_t {
    invalid_atmosphere_type = 0;
    reduced_type_a = 1;
    oxidized_type_b = 2;
    carbon_rich_type_c = 3;
    high_temperature = 4;
    gas_giant_atmosphere = 5;
    ice_giant_atmosphere = 6;
}

enum planet_effect_target_t {
    invalid_planet_effect_target = 0;
    gravity = 1;
    axial_tilt = 2;
    day = 3;
    surface_temperature = 4;
    magnetosphere_strength = 5;
    atmopsheric_pressure = 6;
    o2_co2_suitability = 7;
    growth_factor = 8;
    water = 9;
    food = 10;
    energy = 11;
    metal = 12;
    fuel = 13;
    population = 14;
    infrastructure = 15;
    max_population = 16;
}

// NOTE: These are flags.
enum planet_effect_mod_t {
    invalid_planet_effect_mod = 0;
    monthly = 1;   // Apply op monthly, rather than one time.
    cost = 2;      // Applies to the cost of the target property, not the property itself.
}

enum effect_op_t {
    invalid_effect_op = 0;
    add = 1;
    multiply = 2;
}

message planet_effect_t
{
    string name = 1;
    string description = 2;
    float amount = 3;
    int32 months_of_effect = 4;
    int32 months_remaining = 5;
    planet_effect_target_t target = 6;
    uint32 target_modifiers = 7;
    effect_op_t operation = 8;
}

message planet_t
{
    int32 system_id = 1;
    planet_type_t planet_type = 2;
    double mass_kg = 3;
    double radius_km = 4;
    float orbit_au = 5;
    float orbital_period_y = 6; // in Earth years
    float gravity_g = 7; // in G's
    float axial_tilt_d = 8;
    float day_h = 9;
    float surface_temperature_k = 10;
    float magnetosphere_strength = 11; // Earth-scaled (1.0 is like Earth)
    float atmopsheric_pressure = 12; // In "atmospheres" (1.0 is like Earth)
    float o2_co2_suitability = 13; // only applies when atmosphere_type is oxidized_type_b; Earth-scaled
    float ocean_coverage = 14;
    float growth_factor = 15;
    atmosphere_type_t atmosphere_type = 16;
    int32 water = 17;
    int32 food = 18;
    int32 energy = 19;
    int32 metal = 20;
    int32 fuel = 21;
    int32 population = 22;
    int32 infrastructure = 23;
    int32 max_population = 24;
    int32 owner = 25;
    int32 original_owner = 26;
    // TODO: language, culture, religion
    // TODO: visual properties (incl. rings)
    fleet_t garrison = 27;
    // TODO: ground-to-space defenses
    repeated planet_effect_t effects = 28;
}

message location_object_t
{
    fleet_t bases = 1;
    int64 planet_id = 2; // no planet if < 0
    // TODO: orbital position, if planet is nonempty
    // TODO: other kinds of things as well?
}

message system_location_t
{
    repeated location_object_t objects = 1;
    fleets_t units = 2;
}

enum star_class_t {
    invalid_star_class = 0;
    o = 1;
    b = 2;
    a = 3;
    f = 4;
    g = 5;
    k = 6;
    m = 7;
}

message star_t
{
    star_class_t star_class = 1;
    double temperature_k = 2;
    double solar_masses = 3;
    double solar_luminosities = 4;
    double solar_radii = 5;
}

message system_t
{
    string name = 1;
    hex_coord_t coord = 2;
    star_t star = 3;
    repeated system_location_t permanent_locations = 4;
    repeated system_location_t temporary_locations = 5;
    double world_pos_x = 6;
    double world_pos_y = 7;
    int64 first_planet = 8;
    int64 last_planet = 9;
}

message hex_t
{
    hex_coord_t coord = 1;
    int32 province_id = 2;
    int64 first_system = 3;
    int64 last_system = 4;
    fleets_t fleets = 5;
}

message province_t
{
    int32 id = 1;
    int32 owner = 2;
    repeated hex_coord_t hex_coords = 3;
}

message nation_t
{
    int32 id = 1;
    repeated unit_design_t unit_designs = 2;
    repeated province_t provinces = 3;
    repeated uint32 fleets = 4;
    repeated int32 planets = 5;
    bool defeated = 6;
}

message game_state_t
{
    int32 map_width = 1;
    int32 map_height = 2;
    repeated hex_t hexes = 3;
    repeated system_t systems = 4;
    repeated planet_t planets = 5;
    repeated nation_t nations = 6;
}
